# User API Documentation
This api documentation is about user microservice. For keep it simple, api endpoints are devided into few groups.
## auth
this api will used to create user api key from login info, 
invalidate api key (logout), validate api key (validation for other microservices)
the api key sould save in a cookie for requesting

### auth login
this api will be used for login

`
POST: /api/users/auth/login
`

api will take username and password as input and return api key.

| parameter | value | required |
| :------------ | :------------ | :------------ |
| email | validated email address | yes |
|password| - | yes|
|keeploggedin| boolean value (0 or 1)| no |

the api will respond with following values in json format.

|parameter | value | notes |
| :------------ | :------------ | :------------ |
| error | boolean | will return true if success |
| message | string | if there is an error, this will return an error message |
| errorcode | integer | if there is an error, this will return the error code |
| apikey | string | a unique api key that should save in a cookie |
| apikeyexpire | integer | this will return unix time stamp for api key expire date. will not be defined if keeploggedin value was 1|

store the api key in a cookie and use for all api calls.

### auth invalidate api key
this will remove the api key from all registered microservices cache and from the database.

`
POST /api/users/auth/invalidate-api-key
`

this will not take any parameter. the api returns following values.

|parameter|value|
| :------------ | :------------ |
|error|boolean|

### auth validate api key
thia api endpiont is for other microservices to validate the api key.

`
POST /api/users/auth/validate-api-key
`

|parameters|value| required| notes |
| :------------ | :------------ | :------------ | :------------ |
|servicesecret|string | yes | a unique identifire for each microservice.
|apikey|string|yes| - |

the api will respond with following values. the server should save the api keys and the expireation date in cache table for fast access.

|parameter | value | notes |
| :------------ | :------------ | :------------ |
| error | boolean | will return true if success |
| message | string | if there is an error, this will return an error message |
| errorcode | integer | if there is an error, this will return the error code |
| apikey | string | a unique api key that should save in a cookie |
| apikeyexpire | integer | this will return unix time stamp for api key expiration in cache. this will be mostly a shorter period of time|
| usertype | string | (user, researcher or admin) |
## password reset
this set of api endpoints serves as a password reset service. this is consisting of two endpoints.

### password reset request

this will generate a token for restting password, that would be valid for 6hours. The token will be sent to user's email with reset link.

`
POST /api/users/pwreset/request-password-reset
`

the api will take email addreas as the parameter. 

|parameter|value|required|
| :------------ | :------------ | :------------ |
|email|email address of the user| yes|
|url| string - for callback with the token| no|
the api will respond with following parameters.

|parameter | value | notes |
| :------------ | :------------ | :------------ |
| error | boolean | will return true if success |
| message | string | if there is an error, this will return an error message |
| errorcode | integer | if there is an error, this will return the error code |


### reset the password

once the reset token was genarated, the url with the token will sent to the user's email address.
after that, use this api endpoint for resetting the password.

`
POST /api/users/pwreset/reset-password
`

the api will take following parameters as input

|parameter | value | required |
| :------------ | :------------ | :------------ |
| resettoken | string generated by reset request api. | yes |
| password | the new password | yes |
| password-confirm | the new password confirmation. | yes |

the api will return following data.

|parameter | value | notes |
| :------------ | :------------ | :------------ |
| error | boolean | will return true if success |
| message | string | if there is an error, this will return an error message |
| errorcode | integer | if there is an error, this will return the error code |


## signup
this set of api endpoints provide service to create or remove user accounts, researcher accounts and admin accounts.

### signup user account


### signup researcher account


### signup admin account

> Note: the admin accounts can only created by other admin account.
there will be a default admin account created by system. 

### confirm researcher account
researcher accounts need to be confirmed by admins in order to get prevelages. otherwise the account will be equalent to a user account.
